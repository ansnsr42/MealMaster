{% extends "base.html" %}
{% block content %}
<h2>Einkaufsliste bearbeiten</h2>

<form method="POST" action="{{ url_for('shopping_list') }}">
  <!-- Einkaufsliste darstellen -->
  <table>
    <thead>
      <tr>
        <th>Artikel</th>
        <th>Menge</th>
        <th>Einheit</th>
        <th>Erledigt</th>
      </tr>
    </thead>
    <tbody>
      {% for item in slist.items %}
      <tr>
        <td>
          <!-- Ingredient vs custom_name -->
          {% if item.ingredient_id and item.ingredient %}
            <!-- Falls Ingredient vorhanden -->
            {% if item.purchased %}
              <s>{{ item.ingredient.name }}</s> <!-- Durchgestrichen -->
            {% else %}
              {{ item.ingredient.name }}
            {% endif %}
          {% elif item.custom_name %}
            {% if item.purchased %}
              <s>{{ item.custom_name }}</s>
            {% else %}
              {{ item.custom_name }}
            {% endif %}
          {% else %}
            {% if item.purchased %}
              <s>Unbekannt</s>
            {% else %}
              Unbekannt
            {% endif %}
          {% endif %}
        </td>
        <td>
          {% if item.purchased %}
            <s>{{ item.amount if item.amount else '' }}</s>
          {% else %}
            {{ item.amount if item.amount else '' }}
          {% endif %}
        </td>
        <td>
          {% if item.purchased %}
            <s>{{ item.unit if item.unit else '' }}</s>
          {% else %}
            {{ item.unit if item.unit else '' }}
          {% endif %}
        </td>
        <td>
          <input type="checkbox" name="purchased_{{ item.id }}" {% if item.purchased %}checked{% endif %}>
        </td>
      </tr>
      {% endfor %}
    </tbody>
  </table>

  <hr>

  <!-- Neue Artikel hinzufügen -->
  <h4>Neuen Artikel hinzufügen</h4>
  <p>
    <input type="text" name="new_item_name" placeholder="Artikelname" style="width: 200px;">
    <input type="number" step="0.01" name="new_item_amount" placeholder="Menge">
    <input type="text" name="new_item_unit" placeholder="Einheit (z.B. Stück, ml)">
  </p>

  <!-- Buttons: Speichern oder Liste löschen -->
  <button type="submit" name="save" class="btn btn-primary">Speichern</button>
  <button type="submit" name="delete_list" class="btn btn-danger" onclick="return confirm('Liste wirklich löschen?');">
    Liste löschen
  </button>
</form>
{% endblock %}
